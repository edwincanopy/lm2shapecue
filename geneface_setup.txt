# -*- coding: utf-8 -*-

nvidia-smi
pip install torch torchvision
pip install fvcore iopath
pip install 'git+https://github.com/facebookresearch/pytorch3d.git@stable' -v

pip install tensorboard==2.13.0 tensorboardX==2.6.1
pip install pyspy==0.1.1
pip install protobuf==3.20.3
pip install scipy==1.9.1
pip install kornia==0.5.0
pip install trimesh==3.22.0
pip install einops==0.6.1 torchshow==0.5.1
pip install imageio==2.31.1 imageio-ffmpeg==0.4.8
pip install scikit-learn==1.3.0 scikit-image==0.21.0
pip install av==10.0.0 lpips==0.1.4
pip install timm==0.9.2 librosa==0.9.2
pip install openmim==0.3.9
mim install mmcv==2.1.0 # use mim to speed up installation for mmcv
# press cancel
pip install transformers==4.33.2
pip install pretrainedmodels==0.7.4
pip install ninja==1.11.1
pip install faiss-cpu==1.7.4
pip install praat-parselmouth==0.4.3 moviepy==1.0.3
pip install mediapipe==0.10.7
pip install --upgrade attr
pip install beartype==0.16.4 gateloop_transformer==0.4.0
pip install torchode==0.2.0 torchdiffeq==0.2.3
pip install hydra-core==1.3.2 pandas==2.1.3
pip install pytorch_lightning==2.1.2
pip install httpx==0.23.3
pip install gradio==4.16.0
pip install gdown
pip install pyloudnorm webrtcvad pyworld==0.2.1rc0 pypinyin==0.42.0
pip install PyMCubes

git clone https://github.com/yerfor/GeneFacePlusPlus
%cd GeneFacePlusPlus

# note here we removed the code replacing c++14 with c++17

# build extensions, it takes a long time (about 10 min)
bash docs/prepare_env/install_ext.sh

mkdir -p data/binary/videos/May
cd data/binary/videos/May
gdown https://drive.google.com/uc?id=16fNJz5MbOMqHYHxcK_nPP4EPBXWjugR0
cd ../../../..

cd deep_3drecon/BFM
gdown https://drive.google.com/uc?id=1SPM3IHsyNAaVMwqZZGV6QVaV7I2Hly0v
gdown https://drive.google.com/uc?id=1MSldX9UChKEb3AXLVTPzZQcsbGD4VmGF
gdown https://drive.google.com/uc?id=180ciTvm16peWrcpl4DOekT9eUQ-lJfMU
gdown https://drive.google.com/uc?id=1KX9MyGueFB3M-X0Ss152x_johyTXHTfU
gdown https://drive.google.com/uc?id=19-NyZn_I0_mkF-F5GPyFMwQJ_-WecZIL
gdown https://drive.google.com/uc?id=11ouQ7Wr2I-JKStp2Fd1afedmWeuifhof
gdown https://drive.google.com/uc?id=18ICIvQoKX-7feYWP61RbpppzDuYTptCq
gdown https://drive.google.com/uc?id=1VktuY46m0v_n_d4nvOupauJkK4LF6mHE
cd ../..

mkdir -p checkpoints
cd checkpoints
gdown https://drive.google.com/uc?id=1O5C1vK4yqguOhgRQ7kmYqa3-E8q5H_65
unzip motion2video_nerf.zip
mkdir audio2motion_vae
cd audio2motion_vae
gdown https://drive.google.com/uc?id=1Qg5V-1-IyEgAOxb2PbBjHpYkizuy6njf
gdown https://drive.google.com/uc?id=1bKY5rn3vcAkv-2m1mui0qr4Fs38jEmy-
cd ../..

# SETUP ENDS HERE
# INFERENCE NEXT
